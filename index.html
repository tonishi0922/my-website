<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Introduce</title>
  </head>
  <body>
    <ui-layout>
      <ui-container full-height gap="6">
        <ui-stack justify="center" padding="4">
          <avatar-card
            orientation="horizontal"
            name="tonishi0922"
            description="Frontend Engineer"
            imageSrc="/avatar.png"
          >
          </avatar-card>
        </ui-stack>
        <ui-button ty></ui-button>
        <ui-stack>
          <video-player
            src="https://storage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4"
          ></video-player>
        </ui-stack>
        <ui-stack orientation="vertical" padding="4">
          <ui-divider></ui-divider>
          <ui-title title="works" size="6"></ui-title>
          <ui-stack wrap="wrap">
            <a href="https://github.com/tonishi0922/vanilla-components">
              <ui-image
                src="/vanilla.png"
                alt="GoalPulse image"
                caption="Vanilla Components"
              ></ui-image>
            </a>
          </ui-stack>
        </ui-stack>
        <ui-stack orientation="vertical" padding="8" gap="0">
          <ui-divider></ui-divider>
          <ui-title title="About" size="6"></ui-title>
          <ui-stack padding="4">
            <ui-text
              >フロントエンドを中心に、UI 設計や Web
              サイト開発を担当しています。 <br />特に “情報が整理された UI” や
              “扱いやすいUI API”
              を考えるのが好きで、共通化・再利用・アクセシビリティを意識した設計を得意としています。<br />
              仕様策定、品質管理、ベンダーコントロールなど、裏側の調整も好きなタイプです。</ui-text
            >
          </ui-stack>
        </ui-stack>
        <ui-stack orientation="vertical" padding="8" gap="4">
          <ui-divider></ui-divider>
          <ui-title title="Contact" size="6"></ui-title>
          <form
            action="https://formspree.io/f/xgvglbld"
            method="POST"
            id="contact-form"
          >
            <ui-input
              label-text="お名前"
              type="text"
              placeholder="山田太郎"
              id="name"
              name="name"
              required="true"
            ></ui-input>
            <ui-input
              label-text="会社名"
              type="text"
              placeholder="〇〇株式会社"
              id="company"
              name="company"
            ></ui-input>
            <ui-input
              label-text="メールアドレス"
              type="text"
              placeholder="xxxx@mail.com"
              id="email"
              name="email"
            ></ui-input>
            <ui-input
              label-text="問い合わせ内容"
              type="textarea"
              id="content"
              required="true"
            ></ui-input>
            <ui-button
              id="send-button"
              variant="secondary"
              justify="center"
              type="submit"
              >送信</ui-button
            >
          </form>
        </ui-stack>
      </ui-container>
    </ui-layout>
    <script type="module">
      import "/src/app/register.ts";

      window.addEventListener("DOMContentLoaded", () => {
        const card = document.querySelector("avatar-card");
        card.links = [
          { label: "GitHub", href: "https://github.com/tonishi0922" },
          { label: "X", href: "https://x.com/tmk705880145" },
        ];
      });

      window.addEventListener("DOMContentLoaded", () => {
        const form = document.getElementById("contact-form");
        const storageKey = "contact-form-data";
        const getInputs = () => Array.from(form.querySelectorAll("ui-input"));
        const loadSaved = () => {
          try {
            const saved = JSON.parse(localStorage.getItem(storageKey) ?? "{}");
            getInputs().forEach((el) => {
              const key = el.getAttribute("id") ?? el.getAttribute("label-for");
              if (!key) return;
              const value = saved[key];
              if (typeof value === "string") {
                el.setAttribute("value", value);
              }
            });
          } catch {
            localStorage.removeItem(storageKey);
          }
        };
        const save = () => {
          const data = {};
          getInputs().forEach((el) => {
            const key = el.getAttribute("id") ?? el.getAttribute("label-for");
            if (!key) return;
            data[key] = el.getAttribute("value") ?? "";
          });
          localStorage.setItem(storageKey, JSON.stringify(data));
        };

        loadSaved();
        form.addEventListener("input", save);
        form.addEventListener("change", save);

        form.addEventListener("submit", async (e) => {
          e.preventDefault();
          const data = new FormData(form);

          const btn = document.getElementById("send-button");
          btn.textContent = "送信中...";

          console.log({
            method: "POST",
            body: data,
            headers: { Accept: "application/json" },
          });
          const res = await fetch(form.action, {
            method: "POST",
            body: data,
            headers: { Accept: "application/json" },
          });

          if (res.ok) {
            alert("送信しました！");
            form.reset();
            localStorage.removeItem(storageKey);
            btn.textContent = "送信";
          } else {
            alert("送信に失敗しました");
            btn.textContent = "送信";
          }
        });
      });
    </script>
  </body>
</html>
